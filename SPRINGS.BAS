10 REM: SPRINGS
20 REM: TORSION SPRING CALCULATIONS
30 REM: WRITTEN BY ALAN HALL DECEMBER 1985 (REVISED May 3, 1994)
40 REM: COPYRIGHT 1985,1986,1987,1988,1989,1990,1991,1992,1993,1994
50 REM: TEST FOR VIDEO MODE
60 ON ERROR GOTO 80
70 SCREEN 9,0:COLOR 3,0:VIDEO$="EGA":GOTO 110
80 CLEAR: ON ERROR GOTO 100
90 SCREEN 3,0:VIDEO$="MGA":GOTO 110
100 CLEAR:SCREEN 0,0:COLOR 3,0:VIDEO$="CGA"
110 ON ERROR GOTO 0
120 KEY OFF
130 CLS:LOCATE 12,1:PRINT TAB(15) "********** TORSION SPRING CALCULATIONS **********":PRINT TAB(30)"("VIDEO$" Video Detected)":PRINT
140 PRINT TAB(13)"Written By Alan Hall Using Microsoft GWBasic Ver. 3.20":PRINT
150 IF VIDEO$="CGA" THEN GOTO 220
160 PI=3.141593:FOR FC=120 TO 123:CIRCLE (FC,300),20,1:NEXT FC
170 FOR X=128 TO 152 STEP 6:CIRCLE (X,300),20,1,PI/2,3*PI/2:NEXT X
180 FOR Y=128 TO 516 STEP 6:CIRCLE (Y,300),20,1,3*PI/2,PI/2
190 IF Y=>146 THEN DRAW "R20"
200 NEXT Y
210 CIRCLE (517,300),20,1,3*PI/2,PI/2 : CIRCLE (518,300),20,1,3*PI/2,PI/2
220 LOCATE 25,28,1:SHELL "PAUSE"
230 I$ = CHR$(34): IP$ = I$ + "/#"
240 KEY 1,"":KEY 2,"":KEY 3,"":KEY 4,"":KEY 5,"":KEY 6,"":KEY 7,"":KEY 8,""
250 KEY 9,"":KEY 10,""
260 SCREEN 0:CLS:COLOR 7,1
270 PRINT TAB(15)"********** TORSION SPRING CALCULATIONS **********"TAB(79)""
280 COLOR 7,0:PRINT
290 INPUT "WIRE DIAMETER"; WD: GOTO 360
300 INPUT "OUTSIDE DIAMETER"; OD
310 INPUT "SPRING LENGTH,QUANTITY"; LC, NS
320 INPUT "STANDARD 12,500 CYCLES <Y=YES  N=NO>"; CY$
330 IF CY$ = "Y" OR CY$ = "y" THEN CY = 12500: GOTO 880
340 IF CY$ = "N" OR CY$ = "n" THEN GOTO 350 ELSE BEEP: PRINT : GOTO 320
350 INPUT "CYCLES"; CY: GOTO 880
360 IF WD = .148 THEN D3 = .003242: IP = 4435: LW = .0048683: CO = 6.7568: AT = 227500!: GOTO 300
370 IF WD = .162 THEN D3 = .004252: IP = 6365: LW = .0058333: CO = 6.1728: AT = 227500!: GOTO 300
380 IF WD = .177 THEN D3 = .005545: IP = 9069: LW = .0069633: CO = 5.4697: AT = 222500!: GOTO 300
390 IF WD = .187 THEN WD = .1875: D3 = .006592: IP = 11420: LW = .0078142: CO = 5.3333: AT = 222500!: GOTO 300
400 IF WD = .192 THEN D3 = .007078: IP = 12556: LW = .0081933: CO = 5.2083: AT = 222500!: GOTO 300
410 IF WD = .207 THEN D3 = .00887: IP = 16965: LW = .009525: CO = 4.8308: AT = 217500!: GOTO 300
420 IF WD = .218 THEN WD = .21875: D3 = .01046: IP = 21138: LW = .0106333: CO = 4.5724: AT = 217500!: GOTO 300
430 IF WD = .225 THEN WD = .2253: D3 = .011436: IP = 23805: LW = .0112833: CO = 4.4385: AT = 217500!: GOTO 300
440 IF WD = .234 THEN WD = .234375: D3 = .012813: IP = 27703: LW = .0122083: CO = 4.2735: AT = 215000!: GOTO 300
450 IF WD = .237 THEN WD = .2375: D3 = .013396: IP = 29398: LW = .0125916: CO = 4.2105: AT = 215000!: GOTO 300
460 IF WD = .243 THEN WD = .2437: D3 = .014473: IP = 32580: LW = .0132: CO = 4.1034: AT = 212500!: GOTO 300
470 IF WD = .25 THEN D3 = .015625: IP = 36093!: LW = .0138916: CO = 4: AT = 212500!: GOTO 300
480 IF WD = .262 THEN WD = .2625: D3 = .018088: IP = 43868!: LW = .0156833: CO = 3.8095: AT = 207500!: GOTO 300
490 IF WD = .273 THEN D3 = .020346: IP = 51300!: LW = .0166667: CO = 3.663: AT = 207500!: GOTO 300
500 IF WD = .281 THEN WD = .28125: D3 = .022235: IP = 57778!: LW = .0175833: CO = 3.5562: AT = 207500!: GOTO 300
510 IF WD = .283 THEN D3 = .022665: IP = 59264!: LW = .0178: CO = 3.5335: AT = 207500!: GOTO 300
520 IF WD = .289 THEN D3 = .024138: IP = 64456!: LW = .0186: CO = 3.4602: AT = 205000!: GOTO 300
530 IF WD = .295 THEN D3 = .025672: IP = 69977!: LW = .0191935: CO = 3.3898: AT = 205000!: GOTO 300
540 IF WD = .297 THEN WD = .296875: D3 = .026198: IP = 71894!: LW = .0195916: CO = 3.367: AT = 205000!: GOTO 300
550 IF WD = .306 THEN WD = .3065: D3 = .028793: IP = 81543!: LW = .0208833: CO = 3.2626: AT = 202500!: GOTO 300
560 IF WD = .312 THEN WD = .3125: D3 = .030518: IP = 88119!: LW = .0217083: CO = 3.2: AT = 202500!: GOTO 300
570 IF WD = .319 THEN WD = .3195: D3 = .032615: IP = 96284!: LW = .022965: CO = 3.1298: AT = 202500!: GOTO 300
580 IF WD = .331 THEN D3 = .036265: IP = 110915!: LW = .02435: CO = 3.0211: AT = 197500!: GOTO 300
590 IF WD = .343 THEN WD = .34375: D3 = .040601: IP = 128933!: LW = .0262666: CO = 2.9095: AT = 197500!: GOTO 300
600 IF WD = .363 THEN WD = .3635: D3 = .047635: IP = 159552!: LW = .0292083: CO = 2.7586: AT = 197500!: GOTO 300
610 IF WD = .375 THEN D3 = .052734: IP = 182724!: LW = .0312583: CO = 2.6667: AT = 197500!: GOTO 300
620 IF WD = .387 THEN WD = .3875: D3 = .058185: IP = 208334!: LW = .0333763: CO = 2.5806: AT = 19200: GOTO 300
630 IF WD = .393 THEN WD = .3938: D3 = .06107: IP = 222206!: LW = .034466: CO = 2.5393: AT = 192000!: GOTO 300
640 IF WD = .406 THEN WD = .40625: D3 = 6.702201E-02: IP = 251546!: LW = .0366833: CO = 2.4618: AT = 191000!: GOTO 300
650 IF WD = .421 THEN WD = .421875: D3 = .075045: IP = 292475!: LW = .0395583: CO = 2.3707: AT = 190000!: GOTO 300
660 IF WD = .43 THEN WD = .4305: D3 = .079785: IP = 317368!: LW = .0411917: CO = 2.3229: AT = 190000!: GOTO 300
670 IF WD = .437 THEN WD = .4375: D3 = 8.374001E-02: IP = 338448!: LW = .0425416: CO = 2.2857: AT = 190000!: GOTO 300
680 IF WD = .453 THEN WD = .453125: D3 = .093021: IP = 389344!: LW = .0456333: CO = 2.207: AT = 190000!: GOTO 300
690 IF WD = .461 THEN WD = .4615: D3 = .098291: IP = 419109!: LW = .0473417: CO = 2.1668: AT = 185000!: GOTO 300
700 IF WD = .468 THEN WD = .46875: D3 = .102964: IP = 445807!: LW = .0488416: CO = 2.1335: AT = 185000!: GOTO 300
710 IF WD = .484 THEN WD = .484375: D3 = .113661: IP = 508688!: LW = .05215: CO = 2.0644: AT = 185000!: GOTO 300
720 IF WD = .49 THEN D3 = .117649: IP = 532662!: LW = .0533667: CO = 2.0408: AT = 185000!: GOTO 300
730 IF WD = .5 THEN D3 = .125: IP = 577500!: LW = .0555666: CO = 2!: AT = 180000!: GOTO 300
740 IF WD = .531 THEN WD = .53125: D3 = .149933: IP = 735983!: LW = .0627333: CO = 1.8825: AT = 177500!: GOTO 300
750 IF WD = .562 THEN WD = .5625: D3 = .177978: IP = 925044!: LW = .070325: CO = 1.7778: AT = 175000!: GOTO 300
760 IF WD = .578 THEN WD = .578125: D3 = .193201: IP = 1032015!: LW = .0742917: CO = 1.7298: AT = 175000!: GOTO 300
770 IF WD = .593 THEN WD = .59375: D3 = .209373: IP = 1148761!: LW = .0783583: CO = 1.6841: AT = 172500!: GOTO 300
780 IF WD = .625 THEN D3 = .244141: IP = 1409913!: LW = .0868335: CO = 1.6: AT = 172500!: GOTO 300
790 BEEP: : COLOR  7,4 : PRINT : PRINT " **** WIRE DIAMETER NOT ON FILE **** "
800 PRINT : COLOR 7,1 : PRINT " **** SELECT CORRECT WIRE DIAMETER **** ": PRINT
810 PRINT ".148   .162   .177   .187   .192   .207   .218": PRINT
820 PRINT ".225   .234   .237   .243   .250   .265   .273": PRINT
830 PRINT ".281   .283   .289   .295   .297   .306   .312": PRINT
840 PRINT ".319   .331   .343   .363   .375   .387   .393": PRINT
850 PRINT ".406   .421   .430   .437   .453   .461   .468": PRINT
860 PRINT ".484   .490   .500   .531   .562   .578   .593   .625"
870 PRINT : COLOR 7,0 : GOTO 290
880 IF CY = 5000 THEN PT = 1.36: GOTO 1210
890 IF CY = 7500 THEN PT = 1.185: GOTO 1210
900 IF CY = 10000 THEN PT = 1.1: GOTO 1210
910 IF CY = 12500 THEN PT = 1.055: GOTO 1210
920 IF CY = 15000 THEN PT = 1.02: GOTO 1210
930 IF CY = 17500 THEN PT = .985: GOTO 1210
940 IF CY = 20000 THEN PT = .96: GOTO 1210
950 IF CY = 22500 THEN PT = .9375: GOTO 1210
960 IF CY = 25000 THEN PT = .92: GOTO 1210
970 IF CY = 30000! THEN PT = .885: GOTO 1210
980 IF CY = 35000! THEN PT = .855: GOTO 1210
990 IF CY = 40000! THEN PT = .83: GOTO 1210
1000 IF CY = 45000! THEN PT = .81: GOTO 1210
1010 IF CY = 50000! THEN PT = .79: GOTO 1210
1020 IF CY = 55000! THEN PT = .77: GOTO 1210
1030 IF CY = 60000! THEN PT = .755: GOTO 1210
1040 IF CY = 65000! THEN PT = .74: GOTO 1210
1050 IF CY = 70000! THEN PT = .73: GOTO 1210
1060 IF CY = 75000! THEN PT = .7200001: GOTO 1210
1070 IF CY = 80000! THEN PT = .71: GOTO 1210
1080 IF CY = 85000! THEN PT = .7: GOTO 1210
1090 IF CY = 90000! THEN PT = .69: GOTO 1210
1100 IF CY = 95000! THEN PT = .685: GOTO 1210
1110 IF CY = 100000! THEN PT = .68: GOTO 1210
1120 BEEP: PRINT : COLOR 7,4 : PRINT " "CY; " CYCLES NOT VALID "
1130 PRINT :COLOR 7,1 : PRINT " SELECT VALID CYCLES (Omit Comma) ": PRINT
1140 PRINT "  5,000    7,500   10,000   12,500 ": PRINT
1150 PRINT " 15,000   17,500   20,000   22,500 ": PRINT
1160 PRINT " 25,000   30,000   35,000   40,000 ": PRINT
1170 PRINT " 45,000   50,000   55,000   60,000 ": PRINT
1180 PRINT " 65,000   70,000   75,000   80,000 ": PRINT
1190 PRINT " 85,000   90,000   95,000  100,000 "
1200 COLOR 7,0 : PRINT : GOTO 350
1210 TS = AT * PT: MD = OD - WD: CN = IP / (MD * 3.1416)
1220 NC = LC * CO: TQ = CN / NC: MP = (TS * D3) / 10.2
1230 MT = MP / TQ: CW = MD * 3.1416 * (CO * LC) * LW: IF NOT T = 0 THEN MTL = MT
1240 OMD=OD-WD:OID=OD-(2*WD):UCL=(NC*3.1416)*OMD
1250 FMD=UCL/((NC+MT)*3.1416):ID=OD-WD:ID=OD-(WD*2):FID=FMD-WD
1260 CLS:PRINT:COLOR 7,1:PRINT" WIRE DIAMETER "WD I$" "
1270 PRINT:PRINT" OUTSIDE DIAMETER "OD I$" (INITIAL INSIDE DIAMETER "ID I$")"
1280 PRINT:PRINT" SPRING LENGTH "LC I$"  QUANTITY "NS" "
1290 PRINT:PRINT " CONSTANT "; CN" "
1300 PRINT:COLOR 7,4:PRINT:PRINT" INCH/POUNDS PER TURN: "; INT(TQ * 100) / 100;" ";IP$" "
1310 IF NS >= 2 THEN TQ = TQ * NS: PRINT : PRINT " TOTAL INCH/POUNDS FOR "; NS; "SPRINGS: "; INT(TQ * 100) / 100; " "; IP$" "
1320 PRINT : PRINT " MAXIMUM INCH/POUNDS: "; INT(MP * 100) / 100; " "; IP$" "
1330 PRINT :PRINT " MAXIMUM TURNS FOR "; CY; " CYCLES: "; INT(MT * 100) / 100" "
1340 PRINT:PRINT" FINAL INSIDE DIAMETER: "INT(FID*1000)/1000 I$" "
1350 PRINT : PRINT " COILED SPRING WEIGHT: "; INT(CW * 100) / 100; " lbs. "
1360 IF NS >= 2 THEN CW = CW * NS: PRINT : PRINT " TOTAL WEIGHT FOR "; NS; "SPRINGS: "; INT(CW * 100) / 100; " lbs. "
1370 LOCATE 24,1:COLOR 7,1:PRINT " DO YOU WISH TO DO ANOTHER SPRING <Y=YES N=NO> "TAB(80)""
1380 LOCATE 23,48,1
1390 AN$=INKEY$:IF LEN(AN$)=0 THEN GOTO 1380
1400 IF AN$="Y" OR AN$="y" OR AN$="N" OR AN$="n" THEN GOTO 1420 ELSE BEEP:GOTO 1390
1410 GOTO 1370
1420 TP = TQ + TP
1430 TSC = TSC + NS: T = T + 1: TW = TW + CW
1440 IF T = 1 THEN MX = MT: GOTO 1460
1450 IF MTL < MX THEN MX = MTL
1460 IF AN$ = "Y" OR AN$ = "y" OR AN$ = "" THEN GOTO 230
1470 CLS : PRINT : PRINT:PRINT:PRINT:PRINT"********************************************************************************"
1480 PRINT : PRINT " TOTAL SPRINGS CALCULATED: "; TSC
1490 PRINT : PRINT " TOTAL INCH/POUNDS PER TURN FOR "; TSC; " SPRINGS:"; INT(TP * 100) / 100; " "; IP$
1500 PRINT : PRINT " MAXIMUM TURNS: "; INT(MX * 100) / 100: PRINT : PRINT " TOTAL WEIGHT FOR "; TSC; " SPRINGS: "; INT(TW * 100) / 100; " lbs."
1510  PRINT : PRINT " SELECT REPLACEMENT SPRINGS MANUALLY FROM CHARTS":PRINT
1520 LOCATE 25,1,1:COLOR 0,7:PRINT" PRESS <F2> TO RE-RUN PROGRAM"TAB(46)"PRESS <F10> TO RETURN TO MAIN MENU ",
1530 LOCATE 24,1:COLOR 7,0:PRINT"************************************ END ***************************************",:LOCATE 24,1,0
1540 KEY 2,"R":KEY 10,"E"
1550 FKEY$=INKEY$
1560 IF FKEY$="R" THEN GOTO 1580
1570 IF FKEY$="E" THEN SYSTEM ELSE GOTO 1550
1580 CLEAR:GOTO 230
